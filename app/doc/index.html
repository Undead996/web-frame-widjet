
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="Описание"
            content="Документация к платежному виджету"
        >
    <title>Виджет</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-c9d8fa83.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-953e3353.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-b12a2749.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;html&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-1e815a84.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="html">html</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#92a5d7dc45" class="toc-h1 toc-link" data-title="Виджет">Виджет</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#f4580bd52c" class="toc-h2 toc-link" data-title="Установка">Установка</a>
                  </li>
                  <li>
                    <a href="#5523223320" class="toc-h2 toc-link" data-title="Вызов виджета">Вызов виджета</a>
                  </li>
                  <li>
                    <a href="#9b266b418c" class="toc-h2 toc-link" data-title="Ответ виджета">Ответ виджета</a>
                  </li>
                  <li>
                    <a href="#8352dd8f04" class="toc-h2 toc-link" data-title="Демо">Демо</a>
                  </li>
                  <li>
                    <a href="#8034cc9705" class="toc-h2 toc-link" data-title="Тестовые данные">Тестовые данные</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='92a5d7dc45'>Виджет</h1><h2 id='f4580bd52c'>Установка</h2>
<blockquote>
<p>CDN:</p>
</blockquote>
<div class="highlight"><pre class="highlight html tab-html"><code><span class="c">&lt;!-- ... other HTML ... --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://192.168.121.5:3300/widget/widget.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="c">&lt;!-- ... other HTML ... --&gt;</span>
</code></pre></div>
<p>Подключить скрипт на страницу в раздел <strong>head</strong> через CDN</p>

<p>(Возможны другие варианты скачать файлом/npm/yarn/git смотря где и как будем размещать)</p>
<h2 id='5523223320'>Вызов виджета</h2><h3 id='260f8e102f'>Назначить обработчик события</h3>
<blockquote>
<p>Обработчик <strong>openWidget</strong></p>
</blockquote>
<div class="highlight"><pre class="highlight html tab-html"><code><span class="c">&lt;!-- ... other HTML ... --&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">'pay_button'</span> <span class="na">onclick=</span><span class="s">'openWidget(dataObject)'</span><span class="nt">&gt;</span>Оплатить<span class="nt">&lt;/button&gt;</span>
<span class="c">&lt;!-- ... other HTML ... --&gt;</span>
</code></pre></div>
<p>Назначить вызов функции <strong>openWidget</strong> обработчиком события на элемент страницы, например, на нажатие кнопки &quot;Оплатить&quot;.</p>
<h3 id='9c7c8c95c1'>Передача данных в виджет</h3>
<p>В функцию <strong>openWidget</strong> передать объект с данными для открытия виджета.</p>
<h3 id='openwidget'>Структура объекта для openWidget</h3>
<blockquote>
<p>Объект dataObject</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>    <span class="kd">const</span> <span class="nx">dataObject</span> <span class="o">=</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">frame_id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">some_id</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">frame_name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">some_name</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">proc_url</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://someurl.pay</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">pay_params</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">comment</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Оплата в MyShop</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">keyt_shop</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">00000000000000000000</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">num_shop</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0000</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">summ</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">00</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">onSuccess</span><span class="dl">"</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">/// Действия при успехе</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">onFail</span><span class="dl">"</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">/// Дейсвтия при неуспехе</span>
        <span class="p">}</span>
    <span class="p">};</span>
</code></pre></div>
<table><thead>
<tr>
<th>Параметр</th>
<th>Значение</th>
<th>Тип данных</th>
<th>Пример</th>
</tr>
</thead><tbody>
<tr>
<td><strong>frame_id</strong></td>
<td>id для iframe</td>
<td>string</td>
<td>some_id</td>
</tr>
<tr>
<td><strong>frame_name</strong></td>
<td>имя для iframe</td>
<td>string</td>
<td>some_name</td>
</tr>
<tr>
<td><strong>proc_url</strong></td>
<td>адрес сервиса</td>
<td>string</td>
<td>https://someurl.pay</td>
</tr>
<tr>
<td><strong>pay_params</strong></td>
<td>объект с данными платежа</td>
<td>Object</td>
<td><a href="#pay_params">pay_params</a></td>
</tr>
<tr>
<td><strong>onSuccess</strong></td>
<td>функция обработчик успеха</td>
<td>Object</td>
<td><a href="#onSuccess">onSuccessFunction</a></td>
</tr>
<tr>
<td><strong>onFail</strong></td>
<td>функция обработчик неуспеха</td>
<td>Object</td>
<td><a href="#onFail">onFailFunction</a></td>
</tr>
</tbody></table>
<h3 id='pay_params'><a name="pay_params"></a>Структура объекта pay_params</h3>
<table><thead>
<tr>
<th>Параметр</th>
<th>Значение</th>
<th>Тип данных</th>
<th>Пример</th>
</tr>
</thead><tbody>
<tr>
<td><strong>comment</strong></td>
<td>сообщение пользователю</td>
<td>string</td>
<td>Оплата в MyShop</td>
</tr>
<tr>
<td><strong>keyt_shop</strong></td>
<td>номер счета магазина</td>
<td>string</td>
<td>40914810600000000004</td>
</tr>
<tr>
<td><strong>num_shop</strong></td>
<td>номер магазина</td>
<td>string</td>
<td>4010</td>
</tr>
<tr>
<td><strong>summ</strong></td>
<td>сумма оплаты в рублях</td>
<td>string</td>
<td>250</td>
</tr>
<tr>
<td><strong>payform</strong></td>
<td>номер платежной формы (не обязателен)</td>
<td>string</td>
<td>19749</td>
</tr>
<tr>
<td><strong>ext_transact</strong></td>
<td>номер транзакции (не обязателен), если не указан - будет сгенерирован автоматически</td>
<td>string</td>
<td>11221161532256504</td>
</tr>
<tr>
<td><strong>free_param</strong></td>
<td>свободный параметр (не обязателен)</td>
<td>string</td>
<td>любая строка</td>
</tr>
</tbody></table>
<h3 id='onsuccess'><a name="onSuccess"></a>Функция onSuccess</h3>
<p>Вызывается в случае успеха, принимает результат одним аргуметом.</p>
<h3 id='onfail'><a name="onFail"></a>Функция onFail</h3>
<p>Вызывается в случаях:</p>

<ul>
<li>Отказ пользователя от оплаты;</li>
<li>Невозможноcть проведения оплаты пользователем;</li>
<li>Ошибка при оплатe;</li>
</ul>

<p>Принимает результат одним аргуметом.</p>
<h2 id='9b266b418c'>Ответ виджета</h2>
<p>При закрытии виджета, функция переданная в onSuccess/onFail получит одним аргументом объект с результатом платежа.</p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Значение</th>
<th>Тип данных</th>
</tr>
</thead><tbody>
<tr>
<td><strong>result_code</strong></td>
<td>Код результата</td>
<td>string</td>
</tr>
<tr>
<td><strong>result_text</strong></td>
<td>Текстовое описание результата</td>
<td>string</td>
</tr>
<tr>
<td><strong>full_result</strong></td>
<td>Полный ответ процессинга/3DS,  либо false (при ошибке до процессинга)</td>
<td>string/boolean</td>
</tr>
</tbody></table>
<h3 id='result_code'>result_code</h3>
<table><thead>
<tr>
<th>Код</th>
<th>Значение</th>
</tr>
</thead><tbody>
<tr>
<td><strong>0</strong></td>
<td>Успех</td>
</tr>
<tr>
<td><strong>101</strong></td>
<td>Пользователь отказался от оплаты</td>
</tr>
<tr>
<td><strong>иной</strong></td>
<td>Неуспех</td>
</tr>
</tbody></table>
<h2 id='8352dd8f04'>Демо</h2>
<p>Демо-магазин, демонстрирующий работу виджета <a href="http://192.168.121.5:3000">http://192.168.121.5:3000</a></p>
<h2 id='8034cc9705'>Тестовые данные</h2>
<blockquote>
<p>Тестовый объект dataObject</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>    <span class="kd">const</span> <span class="nx">dataObject</span> <span class="o">=</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">frame_id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">payFrame</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">frame_name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">payFrameName</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">proc_url</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://192.168.121.5:3300</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">pay_params</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">comment</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Оплата в MyShop</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">keyt_shop</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">40914810600000000004</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">num_shop</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">4010</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">summ</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">250</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">free_param</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">hello i am free</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">onSuccess</span><span class="dl">"</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">onFail</span><span class="dl">"</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
</code></pre></div>
<p>Данные могут использоваться для открытия тестового виджета</p>

<table><thead>
<tr>
<th>Номер карты</th>
<th>3DS</th>
<th>Результат</th>
</tr>
</thead><tbody>
<tr>
<td>4111111111111111</td>
<td>да</td>
<td>Успешная операция</td>
</tr>
<tr>
<td>4916798373459761</td>
<td>да</td>
<td>Ошибка на этапе 3Ds (3DS failed)</td>
</tr>
<tr>
<td>5105105105105100</td>
<td>нет</td>
<td>Успешная операция</td>
</tr>
<tr>
<td>5376969565684413</td>
<td>нет</td>
<td>Сценарий без 3DS с ошибкой</td>
</tr>
<tr>
<td>5555555555554444</td>
<td>да</td>
<td>Уйдет на запрос статуса (и не завершится никогда)</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="html">html</a>
          </div>
      </div>
    </div>
  </body>
</html>
